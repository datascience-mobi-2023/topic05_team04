---
title: "final dataframe"
author: "Sharujan Suthakaran"
date: "05.Juli 2023"
---

```{r}
breast_exp_mean <- apply(breast_prism.exp, 2, mean)

achilles.genes.adj <- as.data.frame(p.adjust(unlist(achilles.genes), method = "fdr"))

rownames(achilles.genes.adj) <- rownames(achilles.genes)

w.genes.cancer <- names(breast.achilles.mean)[which(breast.achilles.mean<(-1))]

names.target <- as.vector(targets.treat$name)


```


```{r}

Wgene.krebs <- data.frame()

for (gene_name in w.genes.cancer) {
    frequency_value <- hist.targets[hist.targets$genes == gene_name, "Freq"]
    achilles_value <- breast_achilles_mean[gene_name]
    exp_value <- breast_exp_mean[gene_name]
    p_value <- achilles.genes.adj[gene_name,]
    variant_class <- prism.snv[prism.snv$Hugo_Symbol == gene_name, "Variant_Classification"]
    if (gene_name%in%targets.treat$target){
      names <- paste(names.target[which(targets.treat$target==gene_name)], collapse = ", ")
      treatments <- trimws(names, whitespace = "right")
    }
      else {
        treatments <- c("none")
      }
      
    new_row <- c(frequency_value, achilles_value, exp_value, p_value, variant_class, treatments)
  if (gene_name == w.genes.cancer[1]) {
    Wgene.krebs <- new_row
  } 
    else {
    Wgene.krebs <- rbind(Wgene.krebs, new_row)
  }
}

rownames(Wgene.krebs) <- w.genes.cancer

colnames(Wgene.krebs) <- c("Frequency in list.targets", "mean prism.achilles", "mean prism.exp", "p-value from achilles.genes.adj","Mutation type","treatments")


```
